{% load static %}
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{{ book.title }}</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}">
  <!-- bootstrap default styling file-->
  <link rel="stylesheet" href="{% static "css/myorders.css" %}">
  <link rel="stylesheet" href="{% static "css/rating.css" %}">
  <!-- bootstrap default styling file-->
  <style type="text/css" media="screen">
    /*   .bord{
        border: 2px solid black;
      }

      .long{
        height: 400px;
        border: 2px solid black;
      }
      table tr td{
        width: 500px;
        padding: 50px;
      }
*/

    .imag {
      height: 130px;
    }

    .rating {
      unicode-bidi: bidi-override;
      direction: rtl;
    }

    .rating>span {
      display: inline-block;
      position: relative;
      width: 1.1em;
    }

    .rating>span:hover:before,
    .rating>span:hover~span:before {
      content: "\2605";
      position: absolute;
    }
  </style>
</head>

<body>

  <div class="container" id="mainDiv">

    <nav class="row navbar navbar-expand-lg navbar-light bg-light">

      <a class="navbar-brand" href="admin_home.html">StickToBox</a>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse position-relative" id="navbarNav">
        <ul class="navbar-nav">

          <li class="nav-item">
            <a class="nav-link" href="{% url 'books:author-list' %}">Authors</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="{% url 'books:book-list' %}">Books</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="{% url 'books:category-list' %}">Categories</a>
          </li>

          <li class="nav-item ">
            <a class="nav-link" href="../php/logout.php">Logout</a>
          </li>

        </ul>
      </div>

      <div class="row position-absolute right h-100">
        <div class="col-md-4">
          <img src="{% static "img/ninja.png" %}" class="img-thumbnail imgindiv">
        </div>

        <div class="col-md-8 px-2">
          <p>User</p>
        </div>
      </div>

    </nav>

    <div class="row bord p-3">
      <div class="col-2 long">
        <div align="center">
          <img class="imag img-fluid" src="{{ book.image.url }}" alt="">
        </div>
      </div>

      <div class="col-10 long">
        <div class="row">
          Name : {{ book.title }}  
        </div>
        <div class="row">
          By: <a href="{% url 'books:author-detail' book.author.all.0.id %}">{{book.author.all.0.full_name}}</a>
        </div>
        <div class="row">
          Rating
        </div>
        <div id="rate" class="rating">
          <input type="radio" id="star5" name="rating" value="5" />
          <label for="star5" title="Rocks!">5 stars</label>
          <input type="radio" id="star4" name="rating" value="4" />
          <label for="star4" title="Pretty good">4 stars</label>
          <input type="radio" id="star3" name="rating" value="3" />
          <label for="star3" title="Meh">3 stars</label>
          <input type="radio" id="star2" name="rating" value="2" />
          <label for="star2" title="Kinda bad">2 stars</label>
          <input type="radio" id="star1" name="rating" value="1" />
          <label for="star1" title="Sucks big time">1 star</label>
        </div>
      </div>

    </div>
    <div class="row long p-3">
      <div class="col-2">
        <div class="row p-3">
          <p class="row">Description</p>
        </div>
        <div class="row bord">
          {{ book.summary }}
        </div>
      </div>

      <div class="col-10 p-3">
        <div class="row">
          <p class="row">Reviews</p>
        </div>
        <div class="row bord">
          <div class="col-12">
            {% for commentObject in book.profilebook_set.all %}
            <div class="row">
              <div class="col-2">
                <img class="imag img-fluid" src="{% static "img/book.png" %}" alt="">
              </div>
              <div class="col-7">
                <p>
                  {{ commentObject.comment }}
                </p>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>

      <script>
        function rateValue() {
          var inputs = document.getElementsByTagName('input');
          for (var i = 0; i < inputs.length; i++) {
              if (inputs[i].checked) {
                  return parseInt(inputs[i].value);
              }
            }
        }

        function printRate(x) {
            if (x >= 1 && x <= 5) {
                document.getElementById('star'+x).checked = true;
            } 
        }

        function clearRate() {
            var inputs = document.getElementsByTagName('input');
            for (var i=0; i<inputs.length; i++) {
                inputs[i].checked = false;
            }
        }

        document.body.onload = function(e) {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function () {
              if (this.readyState == 4 && this.status == 200) {
                  var response = this.responseText;
                  response = JSON.parse(response);
                  printRate(response);
              }
          };
          xhttp.open("GET", "{% url 'books:service1' book.id %}", true);
          xhttp.send();
      }

      
      </script>

</body>

</html>